local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local hiddenfling = false
local flingPower = 10000

if not ReplicatedStorage:FindFirstChild("juisdfj0i32i0eidsuf0iok") then
    local detection = Instance.new("Decal")
    detection.Name = "juisdfj0i32i0eidsuf0iok"
    detection.Parent = ReplicatedStorage
end

local function fling()
    local hrp, c, vel, movel = nil, nil, nil, 0.1
    while true do
        RunService.Heartbeat:Wait()
        if hiddenfling then
            while hiddenfling and not (c and c.Parent and hrp and hrp.Parent) do
                RunService.Heartbeat:Wait()
                c = LocalPlayer.Character
                hrp = c and c:FindFirstChild("HumanoidRootPart")
            end
            if hiddenfling then
                vel = hrp.Velocity
                hrp.Velocity = vel * flingPower + Vector3.new(0, flingPower, 0)
                RunService.RenderStepped:Wait()
                if c and c.Parent and hrp and hrp.Parent then
                    hrp.Velocity = vel
                end
                RunService.Stepped:Wait()
                if c and c.Parent and hrp and hrp.Parent then
                    hrp.Velocity = vel + Vector3.new(0, movel, 0)
                    movel = movel * -1
                end
            end
        end
    end
end
task.spawn(fling)

local invis_enabled = true
local invis_on = false
local current_method = 1
local seatTeleportPosition = Vector3.new(0, 5000, 0)
local voidLevelYThreshold = -200
local flySettings = {flying = false, speed = 50}
local noclip = false
local infJump = false
local spinEnabled = false
local spinSpeed = 20

local controllerPlayer = nil
local isSlave = false
local standPlatform = nil
local isBusy = false
local signalConnection = nil

local SIGNALS = {
    ["507770239"] = "bring",
    ["507770453"] = "jump",
    ["507770677"] = "fling_target",
    ["507770818"] = "kill",
    ["507771019"] = "stand",
    ["507771955"] = "void",
    ["507772104"] = "spin",
    ["507776879"] = "jumpscare",
    ["507766388"] = "free",
    ["507771666"] = "fling_self"
}

local StatusGui = Instance.new("ScreenGui")
StatusGui.Name = "VenusStatus"
StatusGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
StatusGui.ResetOnSpawn = false

local StatusFrame = Instance.new("Frame")
StatusFrame.Size = UDim2.new(0, 300, 0, 30)
StatusFrame.Position = UDim2.new(0.5, -150, 0, 10)
StatusFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
StatusFrame.BorderSizePixel = 0
StatusFrame.Parent = StatusGui

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 6)
StatusCorner.Parent = StatusFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, 0, 1, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "STATUS: FREE"
StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.TextSize = 14
StatusLabel.Parent = StatusFrame

local function updateStatus(text, color)
    StatusLabel.Text = text
    StatusLabel.TextColor3 = color
end

local function findPlayerPartial(text)
    for _, p in pairs(Players:GetPlayers()) do
        if string.find(string.lower(p.Name), string.lower(text)) or string.find(string.lower(p.DisplayName), string.lower(text)) then
            return p
        end
    end
    return nil
end

local function triggerJumpscare()
    local sc = Instance.new("ScreenGui")
    sc.Name = "JumpscareGUI"
    sc.Parent = LocalPlayer.PlayerGui
    sc.IgnoreGuiInset = true
    local img = Instance.new("ImageLabel")
    img.Parent = sc
    img.Size = UDim2.new(1,0,1,0)
    img.Image = "rbxassetid://5565362953"
    img.BackgroundColor3 = Color3.new(0,0,0)
    local snd = Instance.new("Sound")
    snd.Parent = sc
    snd.SoundId = "rbxassetid://9120339906"
    snd.Volume = 10
    snd.PlayOnRemove = true
    snd:Play()
    task.wait(2)
    sc:Destroy()
end

local function getPlayerMasterIsLookingAt()
    if not controllerPlayer or not controllerPlayer.Character then return nil end
    local masterRoot = controllerPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not masterRoot then return nil end
    local rayOrigin = masterRoot.Position
    local rayDirection = masterRoot.CFrame.LookVector * 1000
    local raycastParams = RaycastParams.new()
    raycastParams.FilterDescendantsInstances = {controllerPlayer.Character, LocalPlayer.Character}
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    local result = workspace:Raycast(rayOrigin, rayDirection, raycastParams)
    if result and result.Instance then
        local hitModel = result.Instance:FindFirstAncestorOfClass("Model")
        if hitModel then
            local pl = Players:GetPlayerFromCharacter(hitModel)
            return pl
        end
    end
    return nil
end

local function targetFlingRoutine(target)
    if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character then
        local lpRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not lpRoot then return end
        isBusy = true
        local oldPos = lpRoot.CFrame
        hiddenfling = true
        local startTime = tick()
        local con
        con = RunService.RenderStepped:Connect(function()
            if tick() - startTime > 2 or not target.Character or not target.Character:FindFirstChild("HumanoidRootPart") then
                con:Disconnect()
                hiddenfling = false
                lpRoot.Velocity = Vector3.zero
                lpRoot.CFrame = oldPos
                isBusy = false
                return
            end
            lpRoot.CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,0.5)
            lpRoot.Velocity = Vector3.new(0,10000,0)
        end)
    end
end

getgenv().SecureMode = true
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Venus",
    Icon = 0,
    LoadingTitle = "Venus Silent",
    LoadingSubtitle = "No Chat Required",
    Theme = "Ocean",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "VenusConfig"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false,
})

local function Notify(title, content, duration)
    Rayfield:Notify({
        Title = title,
        Content = content,
        Duration = duration or 3,
        Image = 4483362458,
    })
end

local function setCharacterTransparency(transparency)
    if LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Transparency = transparency
            end
        end
    end
end

local function toggleInvisibility()
    if not invis_enabled then return end
    invis_on = not invis_on
    if invis_on then
        if current_method == 1 then
            setCharacterTransparency(0.5)
            Notify("Invis", "Enabling invisibility...", 1)
            local character = LocalPlayer.Character
            if character then
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                if humanoidRootPart then
                    local savedpos = humanoidRootPart.CFrame
                    task.wait(0.1)
                    pcall(function() character:MoveTo(seatTeleportPosition) end)
                    task.wait(0.1)
                    if not character:FindFirstChild("HumanoidRootPart") or character.HumanoidRootPart.Position.Y < voidLevelYThreshold then
                        pcall(function() character:MoveTo(savedpos) end)
                        invis_on = false
                        setCharacterTransparency(0)
                        return
                    end
                    local Seat = Instance.new('Seat')
                    Seat.Parent = workspace
                    Seat.Anchored = false
                    Seat.CanCollide = false
                    Seat.Name = 'invischair'
                    Seat.Transparency = 1
                    Seat.Position = seatTeleportPosition
                    local Weld = Instance.new("Weld")
                    Weld.Part0 = Seat
                    local torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
                    if torso then
                        Weld.Part1 = torso
                        Weld.Parent = Seat
                        task.wait()
                        pcall(function() Seat.CFrame = savedpos end)
                        Notify("Invis Enabled", "Method: Seat", 1)
                    else
                        Seat:Destroy()
                    end
                end
            end
        end
    else
        setCharacterTransparency(0)
        Notify("Invis Disabled", "Visible", 1)
        task.spawn(function()
            local inv = workspace:FindFirstChild('invischair')
            if inv then pcall(function() inv:Destroy() end) end
        end)
    end
end

RunService.Stepped:Connect(function()
    if noclip and LocalPlayer.Character then
        for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
            if v:IsA("BasePart") then
                v.CanCollide = false
            end
        end
    end
end)

UserInputService.JumpRequest:Connect(function()
    if infJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass('Humanoid'):ChangeState("Jumping")
    end
end)

function initFly()
    task.spawn(function()
        local bv = Instance.new("BodyVelocity")
        bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        bv.Velocity = Vector3.zero
        local bg = Instance.new("BodyGyro")
        bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
        bg.P = 9e4
        while flySettings.flying and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") do
            local hrp = LocalPlayer.Character.HumanoidRootPart
            local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum then
                hum:ChangeState(Enum.HumanoidStateType.Running)
            end
            if not hrp:FindFirstChild("BodyVelocity") then
                bv.Parent = hrp
                bg.Parent = hrp
            end
            bv.Velocity = Vector3.zero
            local camCF = Camera.CFrame
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then bv.Velocity = bv.Velocity + camCF.LookVector * flySettings.speed end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then bv.Velocity = bv.Velocity - camCF.LookVector * flySettings.speed end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then bv.Velocity = bv.Velocity - camCF.RightVector * flySettings.speed end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then bv.Velocity = bv.Velocity + camCF.RightVector * flySettings.speed end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then bv.Velocity = bv.Velocity + Vector3.new(0, flySettings.speed, 0) end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then bv.Velocity = bv.Velocity - Vector3.new(0, flySettings.speed, 0) end
            bg.CFrame = camCF
            RunService.RenderStepped:Wait()
        end
        bv:Destroy()
        bg:Destroy()
    end)
end

local function standLogic()
    if isSlave and controllerPlayer and controllerPlayer.Character and controllerPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            if not isBusy then
                local char = LocalPlayer.Character
                local tRoot = controllerPlayer.Character.HumanoidRootPart
                local cRoot = char.HumanoidRootPart
                local hum = char:FindFirstChild("Humanoid")
                if hum then
                    hum:ChangeState(Enum.HumanoidStateType.Physics)
                end
                if not standPlatform then
                    standPlatform = Instance.new("Part")
                    standPlatform.Size = Vector3.new(4, 0.5, 4)
                    standPlatform.Transparency = 0.5
                    standPlatform.Color = Color3.fromRGB(0, 255, 255)
                    standPlatform.Material = Enum.Material.ForceField
                    standPlatform.Anchored = true
                    standPlatform.CanCollide = true
                    standPlatform.Name = "StandPlatform"
                    standPlatform.Parent = workspace
                end
                local bob = math.sin(tick() * 2) * 0.8
                local goalCF = tRoot.CFrame * CFrame.new(0, 3 + bob, -4)
                if standPlatform then
                    standPlatform.CFrame = goalCF * CFrame.new(0, -3, 0)
                end
                cRoot.CFrame = cRoot.CFrame:Lerp(goalCF, 0.15)
                cRoot.Velocity = Vector3.zero
            else
                if standPlatform then standPlatform.CFrame = CFrame.new(0, -500, 0) end
            end
        end
    else
        if standPlatform then standPlatform:Destroy() standPlatform = nil end
    end
end
RunService.Heartbeat:Connect(standLogic)

local function executeCommand(cmd)
    if not isSlave then return end
    Notify("Command Received", cmd, 3)
    if cmd == "jump" then
        if LocalPlayer.Character then LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping) end
    elseif cmd == "bring" then
        isBusy = true
        if LocalPlayer.Character and controllerPlayer and controllerPlayer.Character then
            LocalPlayer.Character.HumanoidRootPart.CFrame = controllerPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,3)
        end
        task.wait(0.5)
        isBusy = false
    elseif cmd == "spin" then
        spinEnabled = not spinEnabled
    elseif cmd == "kill" then
        isBusy = true
        LocalPlayer.Character:BreakJoints()
        task.wait(1)
        isBusy = false
    elseif cmd == "void" then
        isBusy = true
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(0, -500, 0)
        task.wait(1)
        isBusy = false
    elseif cmd == "jumpscare" then
        triggerJumpscare()
    elseif cmd == "fling_self" then
        isBusy = true
        hiddenfling = true
        task.wait(2)
        hiddenfling = false
        isBusy = false
    elseif cmd == "fling_target" then
        isBusy = true
        local t = getPlayerMasterIsLookingAt()
        if t then
            Notify("Attacking", "Master wants me to kill " .. t.Name, 3)
            targetFlingRoutine(t)
        else
            isBusy = false
        end
    elseif cmd == "stand" then
        isBusy = false
    elseif cmd == "free" then
        isSlave = false
        controllerPlayer = nil
        if signalConnection then
            signalConnection:Disconnect()
            signalConnection = nil
        end
        if standPlatform then
            standPlatform:Destroy()
            standPlatform = nil
        end
        updateStatus("STATUS: FREE", Color3.fromRGB(100, 255, 100))
        Notify("Freed", "You are no longer controlled.", 5)
    end
end

local function initSignalListener(master)
    if signalConnection then signalConnection:Disconnect() end
    local hum = master.Character and master.Character:FindFirstChild("Humanoid")
    if hum then
        local animator = hum:FindFirstChild("Animator") or hum:WaitForChild("Animator")
        signalConnection = animator.AnimationPlayed:Connect(function(track)
            local id = track.Animation.AnimationId
            local cleanID = string.match(id, "%d+")
            if SIGNALS[cleanID] then
                executeCommand(SIGNALS[cleanID])
            end
        end)
    end
    master.CharacterAdded:Connect(function(newChar)
        local h = newChar:WaitForChild("Humanoid")
        local a = h:WaitForChild("Animator")
        if signalConnection then signalConnection:Disconnect() end
        signalConnection = a.AnimationPlayed:Connect(function(track)
            local id = track.Animation.AnimationId
            local cleanID = string.match(id, "%d+")
            if SIGNALS[cleanID] then
                executeCommand(SIGNALS[cleanID])
            end
        end)
    end)
end

local function broadcastSignal(id)
    if LocalPlayer.Character then
        local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
        local animator = hum and hum:FindFirstChild("Animator")
        if animator then
            local anim = Instance.new("Animation")
            anim.AnimationId = "rbxassetid://" .. id
            local track = animator:LoadAnimation(anim)
            track.Priority = Enum.AnimationPriority.Action
            track:Play()
            task.wait(0.1)
            track:Stop()
        end
    end
end

local MainTab = Window:CreateTab("Main", 4483362458)
MainTab:CreateToggle({
    Name = "Enable Fling",
    CurrentValue = false,
    Flag = "FlingToggle",
    Callback = function(Value)
        hiddenfling = Value
    end,
})
MainTab:CreateSlider({
    Name = "Fling Power",
    Range = {1000, 50000},
    Increment = 1000,
    Suffix = "Power",
    CurrentValue = 10000,
    Flag = "FlingPower",
    Callback = function(Value)
        flingPower = Value
    end,
})
MainTab:CreateToggle({
    Name = "Seat Invisibility",
    CurrentValue = false,
    Flag = "InvisToggle",
    Callback = function(Value)
        if Value ~= invis_on then
            toggleInvisibility()
        end
    end,
})

local connectInputName = ""
MainTab:CreateInput({
    Name = "Master's Name",
    PlaceholderText = "Type Player Name to OBEY",
    RemoveTextAfterFocusLost = false,
    Callback = function(Text)
        connectInputName = Text
    end,
})
MainTab:CreateButton({
    Name = "Submit & Obey",
    Callback = function()
        local t = findPlayerPartial(connectInputName)
        if t and t ~= LocalPlayer then
            controllerPlayer = t
            isSlave = true
            initSignalListener(t)
            updateStatus("SLAVE (Controlled by " .. t.Name .. ")", Color3.fromRGB(255, 50, 50))
            Notify("Submitted", "You are now controlled by " .. t.Name .. ". Auto-Stand active.", 5)
        else
            Notify("Error", "Player invalid or not found", 3)
        end
    end,
})

local RemoteTab = Window:CreateTab("Remote Admin", 4483362458)
RemoteTab:CreateButton({
    Name = "Jumpscare Them",
    Callback = function() broadcastSignal("507776879") end,
})
RemoteTab:CreateButton({
    Name = "Kill Them",
    Callback = function() broadcastSignal("507770818") end,
})
RemoteTab:CreateButton({
    Name = "Fling Them (Up)",
    Callback = function() broadcastSignal("507771666") end,
})
RemoteTab:CreateButton({
    Name = "Void Them",
    Callback = function() broadcastSignal("507771955") end,
})
RemoteTab:CreateButton({
    Name = "Summon as Stand (Reset)",
    Callback = function() broadcastSignal("507771019") end,
})
RemoteTab:CreateButton({
    Name = "Attack My Target (Fling)",
    Callback = function()
        Notify("Order", "Look at a player to order the attack!", 3)
        broadcastSignal("507770677")
    end,
})
RemoteTab:CreateButton({
    Name = "Bring Slaves to Me",
    Callback = function() broadcastSignal("507770239") end,
})
RemoteTab:CreateButton({
    Name = "Make Slaves Jump",
    Callback = function() broadcastSignal("507770453") end,
})
RemoteTab:CreateButton({
    Name = "Toggle Slave Spin",
    Callback = function() broadcastSignal("507772104") end,
})
RemoteTab:CreateButton({
    Name = "Free Slaves",
    Callback = function() broadcastSignal("507766388") end,
})

MainTab:CreateToggle({
    Name = "Fly",
    CurrentValue = false,
    Flag = "FlyToggle",
    Callback = function(Value)
        flySettings.flying = Value
        if flySettings.flying then
            initFly()
        end
    end,
})
MainTab:CreateSlider({
    Name = "Fly Speed",
    Range = {10, 500},
    Increment = 10,
    Suffix = "Studs",
    CurrentValue = 50,
    Flag = "FlySpeed",
    Callback = function(Value)
        flySettings.speed = Value
    end,
})
MainTab:CreateToggle({
    Name = "Noclip",
    CurrentValue = false,
    Flag = "NoclipToggle",
    Callback = function(Value)
        noclip = Value
    end,
})
MainTab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Flag = "InfJumpToggle",
    Callback = function(Value)
        infJump = Value
    end,
})
MainTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 300},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "WalkSpeed",
    Callback = function(Value)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = Value
        end
    end,
})
MainTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 500},
    Increment = 1,
    Suffix = "Power",
    CurrentValue = 50,
    Flag = "JumpPower",
    Callback = function(Value)
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.UseJumpPower = true
            LocalPlayer.Character.Humanoid.JumpPower = Value
        end
    end,
})
MainTab:CreateToggle({
    Name = "SpinBot",
    CurrentValue = false,
    Flag = "SpinToggle",
    Callback = function(Value)
        spinEnabled = Value
    end,
})
MainTab:CreateSlider({
    Name = "Spin Speed",
    Range = {10, 100},
    Increment = 5,
    Suffix = "RPM",
    CurrentValue = 20,
    Flag = "SpinSpeed",
    Callback = function(Value)
        spinSpeed = Value
    end,
})
MainTab:CreateButton({
    Name = "Click TP Tool",
    Callback = function()
        local tool = Instance.new("Tool")
        tool.RequiresHandle = false
        tool.Name = "Click TP"
        tool.Activated:Connect(function()
            local pos = UserInputService:GetMouseLocation()
            local ray = Camera:ViewportPointToRay(pos.X, pos.Y)
            local res = workspace:Raycast(ray.Origin, ray.Direction * 1000)
            if res and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(res.Position + Vector3.new(0, 3, 0))
            end
        end)
        tool.Parent = LocalPlayer.Backpack
        Notify("Tool", "Click TP added to Backpack", 2)
    end,
})

local MiscTab = Window:CreateTab("Misc", 4483362458)
MiscTab:CreateButton({
    Name = "Rejoin Server",
    Callback = function()
        game:GetService("TeleportService"):Teleport(game.PlaceId, LocalPlayer)
    end,
})
MiscTab:CreateButton({
    Name = "Destroy UI",
    Callback = function()
        Rayfield:Destroy()
    end,
})
