local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local VirtualUser = game:GetService("VirtualUser")
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local StarterGui = game:GetService("StarterGui")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

local hiddenfling = false
local flingPower = 15000 
local loopFlingTarget = nil
local loopFlingConnection = nil

local Visualizer
local invis_enabled = true
local invis_on = false
local current_method = 1
local invis_transparency = 0.5
local seatTeleportPosition = Vector3.new(0, 9000, 0)
local currentSeatPosition = nil
local seatHeartbeat

local flySettings = {flying = false, speed = 50}
local noclip = false
local espEnabled = false
local infJump = false
local spinEnabled = false
local spinSpeed = 20
local spinBody

local controllerPlayer = nil 
local isSubordinate = false 
local standMode = false
local standPlatform = nil
local isBusy = false
local orbitMode = false
local carpetMode = false
local orbitAngle = 0
local auraEnabled = false
local auraParts = {}
local attributeConnection = nil

local waypoints = {}
local waypointFile = "Venus_Waypoints.json"

local chatLogs = {}
local maxLogs = 50

if not ReplicatedStorage:FindFirstChild("juisdfj0i32i0eidsuf0iok") then
	local detection = Instance.new("Decal")
	detection.Name = "juisdfj0i32i0eidsuf0iok"
	detection.Parent = ReplicatedStorage
end

local function fling()
	local hrp, c, vel, movel = nil, nil, nil, 0.1
	while true do
		RunService.Heartbeat:Wait()
		if hiddenfling then
			while hiddenfling and not (c and c.Parent and hrp and hrp.Parent) do
				RunService.Heartbeat:Wait()
				c = LocalPlayer.Character
				hrp = c and c:FindFirstChild("HumanoidRootPart")
			end
			if hiddenfling then
				vel = hrp.Velocity
				hrp.Velocity = vel * flingPower + Vector3.new(0, flingPower, 0)
				RunService.RenderStepped:Wait()
				if c and c.Parent and hrp and hrp.Parent then
					hrp.Velocity = vel
				end
				RunService.Stepped:Wait()
				if c and c.Parent and hrp and hrp.Parent then
					hrp.Velocity = vel + Vector3.new(0, movel, 0)
					movel = movel * -1
				end
			end
		end
	end
end

task.spawn(fling)

local StatusGui = Instance.new("ScreenGui")
StatusGui.Name = "VenusStatus"
StatusGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
StatusGui.ResetOnSpawn = false
StatusGui.IgnoreGuiInset = true

local StatusFrame = Instance.new("Frame")
StatusFrame.Size = UDim2.new(0, 300, 0, 30)
StatusFrame.Position = UDim2.new(0.5, -150, 0, 0)
StatusFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
StatusFrame.BorderSizePixel = 0
StatusFrame.Parent = StatusGui

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 0)
StatusCorner.Parent = StatusFrame

local StatusStroke = Instance.new("UIStroke")
StatusStroke.Color = Color3.fromRGB(0, 255, 255)
StatusStroke.Thickness = 2
StatusStroke.Parent = StatusFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, 0, 1, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = "STATUS: FREE AGENT"
StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
StatusLabel.Font = Enum.Font.GothamBlack
StatusLabel.TextSize = 14
StatusLabel.Parent = StatusFrame

local function updateStatus(text, color)
    StatusLabel.Text = text
    StatusLabel.TextColor3 = color
    StatusStroke.Color = color
end

local savedScripts = {}
local scriptFileName = "Venus_SavedScripts.json"

if isfile and isfile(scriptFileName) then
    local decoded = HttpService:JSONDecode(readfile(scriptFileName))
    if decoded then savedScripts = decoded end
end

if isfile and isfile(waypointFile) then
    local decoded = HttpService:JSONDecode(readfile(waypointFile))
    if decoded then waypoints = decoded end
end

local function saveScripts()
    if writefile then
        writefile(scriptFileName, HttpService:JSONEncode(savedScripts))
    end
end

local function saveWaypoints()
    if writefile then
        writefile(waypointFile, HttpService:JSONEncode(waypoints))
    end
end

local function getScriptNames()
    local names = {}
    for n, _ in pairs(savedScripts) do
        table.insert(names, n)
    end
    return names
end

local function getWaypointNames()
    local names = {}
    for n, _ in pairs(waypoints) do
        table.insert(names, n)
    end
    return names
end

local function getPlayerNames()
    local names = {}
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            table.insert(names, p.Name)
        end
    end
    return names
end

local function getRealParts(char, partName)
    local r15 = char:FindFirstChild("UpperTorso")
    local p, m
    if r15 then
        if partName == "Head" then p=char:FindFirstChild("Head") m=p and p:FindFirstChild("Neck") end
        if partName == "Torso" then p=char:FindFirstChild("UpperTorso") m=char:FindFirstChild("LowerTorso") and char.LowerTorso:FindFirstChild("Root") end
        if partName == "Left Arm" then p=char:FindFirstChild("LeftUpperArm") m=p and p:FindFirstChild("LeftShoulder") end
        if partName == "Right Arm" then p=char:FindFirstChild("RightUpperArm") m=p and p:FindFirstChild("RightShoulder") end
        if partName == "Left Leg" then p=char:FindFirstChild("LeftUpperLeg") m=p and p:FindFirstChild("LeftHip") end
        if partName == "Right Leg" then p=char:FindFirstChild("RightUpperLeg") m=p and p:FindFirstChild("RightHip") end
    else
        if partName == "Head" then p=char:FindFirstChild("Head") m=char:FindFirstChild("Torso") and char.Torso:FindFirstChild("Neck") end
        if partName == "Torso" then p=char:FindFirstChild("Torso") m=char:FindFirstChild("HumanoidRootPart") and char.HumanoidRootPart:FindFirstChild("RootJoint") end
        if partName == "Left Arm" then p=char:FindFirstChild("Left Arm") m=char:FindFirstChild("Torso") and char.Torso:FindFirstChild("Left Shoulder") end
        if partName == "Right Arm" then p=char:FindFirstChild("Right Arm") m=char:FindFirstChild("Torso") and char.Torso:FindFirstChild("Right Shoulder") end
        if partName == "Left Leg" then p=char:FindFirstChild("Left Leg") m=char:FindFirstChild("Torso") and char.Torso:FindFirstChild("Left Hip") end
        if partName == "Right Leg" then p=char:FindFirstChild("Right Leg") m=char:FindFirstChild("Torso") and char.Torso:FindFirstChild("Right Hip") end
    end
    return p, m
end

local function findPlayerPartial(text)
    for _, p in pairs(Players:GetPlayers()) do
        if string.find(string.lower(p.Name), string.lower(text)) or string.find(string.lower(p.DisplayName), string.lower(text)) then
            return p
        end
    end
    return nil
end

local function triggerJumpscare()
    local sc = Instance.new("ScreenGui")
    sc.Name = "JumpscareGUI"
    sc.Parent = LocalPlayer.PlayerGui
    sc.IgnoreGuiInset = true
    
    local img = Instance.new("ImageLabel")
    img.Parent = sc
    img.Size = UDim2.new(1,0,1,0)
    img.Image = "rbxassetid://5565362953"
    img.BackgroundColor3 = Color3.new(0,0,0)
    
    local snd = Instance.new("Sound")
    snd.Parent = sc
    snd.SoundId = "rbxassetid://9120339906"
    snd.Volume = 10
    snd.PlayOnRemove = true
    snd:Play()
    
    task.wait(2.5)
    sc:Destroy()
end

local function getPlayerMasterIsLookingAt()
    if not controllerPlayer or not controllerPlayer.Character then return nil end
    local masterRoot = controllerPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not masterRoot then return nil end
    
    local rayOrigin = masterRoot.Position
    local rayDirection = masterRoot.CFrame.LookVector * 1000
    local raycastParams = RaycastParams.new()
    raycastParams.FilterDescendantsInstances = {controllerPlayer.Character, LocalPlayer.Character}
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    
    local result = workspace:Raycast(rayOrigin, rayDirection, raycastParams)
    if result and result.Instance then
        local hitModel = result.Instance:FindFirstAncestorOfClass("Model")
        if hitModel then
            local pl = Players:GetPlayerFromCharacter(hitModel)
            return pl
        end
    end
    return nil
end

local function stopLoopFling()
    if loopFlingConnection then
        loopFlingConnection:Disconnect()
        loopFlingConnection = nil
    end
    hiddenfling = false
    isBusy = false
end

local function startLoopFling(targetName)
    stopLoopFling()
    local t = nil
    if type(targetName) == "string" then
        t = findPlayerPartial(targetName)
    end
    
    if not t or not t.Character then return end
    
    isBusy = true
    hiddenfling = true
    
    loopFlingConnection = RunService.RenderStepped:Connect(function()
        if not t.Character or not t.Character:FindFirstChild("HumanoidRootPart") or not LocalPlayer.Character then
            stopLoopFling()
            return
        end
        local lpRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if lpRoot then
            lpRoot.CFrame = t.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,0.5)
            lpRoot.Velocity = Vector3.new(0,10000,0)
        end
    end)
end

local function targetFlingRoutine(targetName)
    local t = findPlayerPartial(targetName)
    if t and t.Character and t.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character then
        local lpRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if not lpRoot then return end
        
        isBusy = true
        local oldPos = lpRoot.CFrame
        hiddenfling = true
        local startTime = tick()
        
        local con
        con = RunService.RenderStepped:Connect(function()
            if tick() - startTime > 2 or not t.Character or not t.Character:FindFirstChild("HumanoidRootPart") then
                con:Disconnect()
                hiddenfling = false
                lpRoot.Velocity = Vector3.zero
                lpRoot.CFrame = oldPos
                isBusy = false
                return
            end
            lpRoot.CFrame = t.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,0.5)
            lpRoot.Velocity = Vector3.new(0,10000,0)
        end)
    end
end

local function createAura()
    if #auraParts > 0 then return end
    for i = 1, 6 do
        local p = Instance.new("Part")
        p.Size = Vector3.new(1, 1, 1)
        p.Shape = Enum.PartType.Ball
        p.Material = Enum.Material.Neon
        p.Color = Color3.fromRGB(0, 255, 255)
        p.Anchored = true
        p.CanCollide = false
        p.Transparency = 0.3
        p.Parent = workspace
        table.insert(auraParts, p)
    end
end

local function destroyAura()
    for _, p in pairs(auraParts) do
        p:Destroy()
    end
    auraParts = {}
end

RunService.Heartbeat:Connect(function()
    if auraEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if #auraParts == 0 then createAura() end
        local root = LocalPlayer.Character.HumanoidRootPart
        local time = tick()
        for i, part in pairs(auraParts) do
            local angle = time * 2 + (i * (math.pi * 2 / #auraParts))
            local offsetX = math.cos(angle) * 5
            local offsetZ = math.sin(angle) * 5
            local offsetY = math.sin(time * 3 + i) * 2
            part.CFrame = root.CFrame * CFrame.new(offsetX, offsetY, offsetZ)
        end
    else
        destroyAura()
    end
end)

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Venus",
   Icon = 0,
   LoadingTitle = "Venus Client",
   LoadingSubtitle = "Titan Edition",
   Theme = "Ocean",
   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false,
   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "VenusTitanConfig"
   },
   Discord = {
      Enabled = false,
      Invite = "noinvitelink",
      RememberJoins = true
   },
   KeySystem = false, 
})

local function Notify(title, content, duration)
    Rayfield:Notify({
        Title = title,
        Content = content,
        Duration = duration or 3,
        Image = 4483362458,
    })
end

local function setCharacterTransparency(transparency)
    if LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                part.Transparency = transparency
            end
        end
    end
end

local function startSeatReturnHeartbeat()
    if seatHeartbeat then seatHeartbeat:Disconnect() end
    seatHeartbeat = RunService.Heartbeat:Connect(function()
        local seat = workspace:FindFirstChild('invischair')
        if seat and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        end
    end)
end

local function stopSeatReturnHeartbeat()
    if seatHeartbeat then
        seatHeartbeat:Disconnect()
        seatHeartbeat = nil
    end
end

local function toggleInvisibility()
    if not invis_enabled then return end
    invis_on = not invis_on
    
    if invis_on then
        if current_method == 1 then
            setCharacterTransparency(0.5)
            Notify("Invis", "Enabling invisibility...", 1)
            local character = LocalPlayer.Character
            if character then
                local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
                if humanoidRootPart then
                    local savedpos = humanoidRootPart.CFrame
                    task.wait(0.1)
                    pcall(function() character:MoveTo(seatTeleportPosition) end)
                    task.wait(0.1)
                    
                    if not character:FindFirstChild("HumanoidRootPart") or character.HumanoidRootPart.Position.Y < voidLevelYThreshold then
                        pcall(function() character:MoveTo(savedpos) end)
                        invis_on = false
                        setCharacterTransparency(0)
                        return
                    end
                    
                    local Seat = Instance.new('Seat')
                    Seat.Parent = workspace
                    Seat.Anchored = false
                    Seat.CanCollide = false
                    Seat.Name = 'invischair'
                    Seat.Transparency = 1
                    Seat.Position = seatTeleportPosition
                    
                    local Weld = Instance.new("Weld")
                    Weld.Part0 = Seat
                    local torso = character:FindFirstChild("Torso") or character:FindFirstChild("UpperTorso")
                    
                    if torso then
                        Weld.Part1 = torso
                        Weld.Parent = Seat
                        task.wait()
                        pcall(function() Seat.CFrame = savedpos end)
                        currentSeatPosition = Seat.Position
                        Notify("Invis Enabled", "Method: Seat", 1)
                    else
                        Seat:Destroy()
                    end
                end
            end
        end
    else
        setCharacterTransparency(0)
        Notify("Invis Disabled", "Visible", 1)
        task.spawn(function()
            local inv = workspace:FindFirstChild('invischair')
            if inv then pcall(function() inv:Destroy() end) end
        end)
        currentSeatPosition = nil
    end
end

RunService.Stepped:Connect(function()
    if noclip and LocalPlayer.Character then
        for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
            if v:IsA("BasePart") then
                v.CanCollide = false
            end
        end
    end
end)

UserInputService.JumpRequest:Connect(function()
    if infJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass('Humanoid'):ChangeState("Jumping")
    end
end)

function initFly()
     task.spawn(function()
        local bv = Instance.new("BodyVelocity")
        bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
        bv.Velocity = Vector3.zero
        local bg = Instance.new("BodyGyro")
        bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
        bg.P = 9e4
        while flySettings.flying and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") do
           local hrp = LocalPlayer.Character.HumanoidRootPart
           local hum = LocalPlayer.Character:FindFirstChild("Humanoid")
           
           if hum then
               hum:ChangeState(Enum.HumanoidStateType.Running)
           end
           
           if not hrp:FindFirstChild("BodyVelocity") then
              bv.Parent = hrp
              bg.Parent = hrp
           end
           bv.Velocity = Vector3.zero
           local camCF = Camera.CFrame
           if UserInputService:IsKeyDown(Enum.KeyCode.W) then bv.Velocity = bv.Velocity + camCF.LookVector * flySettings.speed end
           if UserInputService:IsKeyDown(Enum.KeyCode.S) then bv.Velocity = bv.Velocity - camCF.LookVector * flySettings.speed end
           if UserInputService:IsKeyDown(Enum.KeyCode.A) then bv.Velocity = bv.Velocity - camCF.RightVector * flySettings.speed end
           if UserInputService:IsKeyDown(Enum.KeyCode.D) then bv.Velocity = bv.Velocity + camCF.RightVector * flySettings.speed end
           if UserInputService:IsKeyDown(Enum.KeyCode.Space) then bv.Velocity = bv.Velocity + Vector3.new(0, flySettings.speed, 0) end
           if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then bv.Velocity = bv.Velocity - Vector3.new(0, flySettings.speed, 0) end
           bg.CFrame = camCF
           RunService.RenderStepped:Wait()
        end
        bv:Destroy()
        bg:Destroy()
     end)
end

local jojoPose = {
    ["Torso"] = {rx=10, ry=0, rz=0},
    ["Head"] = {rx=-10, ry=0, rz=0},
    ["Left Arm"] = {rx=30, rz=-45, ry=20},
    ["Right Arm"] = {rx=90, rz=0, ry=0},
    ["Left Leg"] = {rx=20, rz=-5},
    ["Right Leg"] = {rx=10, rz=5}
}

RunService.Heartbeat:Connect(function()
    if isSubordinate and controllerPlayer and controllerPlayer.Character and controllerPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local char = LocalPlayer.Character
            local tRoot = controllerPlayer.Character.HumanoidRootPart
            local cRoot = char.HumanoidRootPart
            local hum = char:FindFirstChild("Humanoid")
            
            if not isBusy and not orbitMode and not carpetMode then
                if hum then hum:ChangeState(Enum.HumanoidStateType.Physics) end
                
                if not standPlatform then
                   standPlatform = Instance.new("Part")
                   standPlatform.Size = Vector3.new(4, 0.5, 4)
                   standPlatform.Transparency = 0.5
                   standPlatform.Color = Color3.fromRGB(0, 255, 255)
                   standPlatform.Material = Enum.Material.ForceField
                   standPlatform.Anchored = true
                   standPlatform.CanCollide = true
                   standPlatform.Name = "StandPlatform"
                   standPlatform.Parent = workspace
                end
                
                local bob = math.sin(tick() * 2) * 0.8
                local goalCF = tRoot.CFrame * CFrame.new(2, 3 + bob, 2)
                
                if standPlatform then standPlatform.CFrame = goalCF * CFrame.new(0, -3, 0) end
                
                cRoot.CFrame = cRoot.CFrame:Lerp(goalCF, 0.15)
                cRoot.Velocity = Vector3.zero
                
                for n, d in pairs(jojoPose) do
                    local p, m = getRealParts(char, n)
                    if m then
                        if not m:GetAttribute("OrigC0") then m:SetAttribute("OrigC0", m.C0) end
                        local base = m:GetAttribute("OrigC0")
                        local rot = CFrame.Angles(math.rad(d.rx), math.rad(d.ry), math.rad(d.rz))
                        m.C0 = base * rot
                    end
                end
            elseif orbitMode then
                orbitAngle = orbitAngle + 0.05
                local offsetX = math.sin(orbitAngle) * 8
                local offsetZ = math.cos(orbitAngle) * 8
                cRoot.CFrame = tRoot.CFrame * CFrame.new(offsetX, 2, offsetZ)
                cRoot.CFrame = CFrame.new(cRoot.Position, tRoot.Position) 
                cRoot.Velocity = Vector3.zero
            elseif carpetMode then
                cRoot.CFrame = tRoot.CFrame * CFrame.new(0, -3.5, 0) * CFrame.Angles(math.rad(90), 0, 0)
                cRoot.Velocity = Vector3.zero
            else
                if standPlatform then standPlatform.CFrame = CFrame.new(0, -500, 0) end
            end
        end
    else
        if standPlatform then standPlatform:Destroy() standPlatform = nil end
    end
end)

local function executeCommand(cmd, args)
    if not isSubordinate then return end
    
    Notify("Command Received", cmd, 3)
    
    if cmd == "jump" then
        if LocalPlayer.Character then LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping) end
    elseif cmd == "bring" then
        isBusy = true
        if LocalPlayer.Character and controllerPlayer and controllerPlayer.Character then
            LocalPlayer.Character.HumanoidRootPart.CFrame = controllerPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,3)
        end
        task.wait(0.5)
        isBusy = false
    elseif cmd == "spin" then
        spinEnabled = not spinEnabled
    elseif cmd == "kill" then
        isBusy = true
        LocalPlayer.Character:BreakJoints()
        task.wait(1)
        isBusy = false
    elseif cmd == "void" then
        isBusy = true
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(0, -500, 0)
        task.wait(1)
        isBusy = false
    elseif cmd == "rocket" then
        isBusy = true
        LocalPlayer.Character.HumanoidRootPart.Velocity = Vector3.new(0, 10000, 0)
        task.wait(1)
        isBusy = false
    elseif cmd == "freeze" then
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.Anchored = not LocalPlayer.Character.HumanoidRootPart.Anchored
        end
    elseif cmd == "fly" then
        flySettings.flying = true
        initFly()
    elseif cmd == "unfly" then
        flySettings.flying = false
    elseif cmd == "noclip" then
        noclip = true
    elseif cmd == "clip" then
        noclip = false
    elseif cmd == "jumpscare" then
        triggerJumpscare()
    elseif cmd == "fling" then
        isBusy = true
        hiddenfling = true
        task.wait(2)
        hiddenfling = false
        isBusy = false
    elseif cmd == "fling_target" then
        isBusy = true
        local t = getPlayerMasterIsLookingAt()
        if t then
            Notify("Attacking", "Controller target: " .. t.Name, 3)
            targetFlingRoutine(t.Name)
        else
            isBusy = false
        end
    elseif cmd == "loopfling" then
        startLoopFling(args)
    elseif cmd == "stopfling" then
        stopLoopFling()
    elseif cmd == "stand" then
        isBusy = false
        orbitMode = false
        carpetMode = false
    elseif cmd == "unstand" then
        isBusy = true
        orbitMode = false
        carpetMode = false
    elseif cmd == "orbit" then
        isBusy = false
        orbitMode = not orbitMode
        carpetMode = false
    elseif cmd == "carpet" then
        isBusy = false
        orbitMode = false
        carpetMode = not carpetMode
    end
end

local function initSilentListener(master)
    if not master then return end
    if not master.Character then return end
    
    if attributeConnection then attributeConnection:Disconnect() end
    
    attributeConnection = master.Character.AttributeChanged:Connect(function(attr)
        if attr == "VenusCmd" then
            local raw = master.Character:GetAttribute("VenusCmd")
            if not raw then return end
            
            local split = string.split(raw, " ")
            local cmd = split[1]
            local args = split[2]
            local id = split[3] 
            
            if cmd and id ~= LocalPlayer:GetAttribute("LastCmdID") then
                LocalPlayer:SetAttribute("LastCmdID", id)
                executeCommand(cmd, args)
            end
        end
    end)
    
    master.CharacterAdded:Connect(function(newChar)
        if attributeConnection then attributeConnection:Disconnect() end
        attributeConnection = newChar.AttributeChanged:Connect(function(attr)
            if attr == "VenusCmd" then
                local raw = newChar:GetAttribute("VenusCmd")
                if not raw then return end
                
                local split = string.split(raw, " ")
                local cmd = split[1]
                local args = split[2]
                local id = split[3] 
                
                if cmd and id ~= LocalPlayer:GetAttribute("LastCmdID") then
                    LocalPlayer:SetAttribute("LastCmdID", id)
                    executeCommand(cmd, args)
                end
            end
        end)
    end)
end

local function sendCmd(cmd, args)
    if LocalPlayer.Character then
        local fullCmd = cmd .. " " .. (args or "none") .. " " .. tostring(math.random(1,100000))
        LocalPlayer.Character:SetAttribute("VenusCmd", fullCmd)
    end
end

local MainTab = Window:CreateTab("Main", 4483362458)

local SectionDesync = MainTab:CreateSection("Fling & Invis")

MainTab:CreateToggle({
   Name = "Enable Fling",
   CurrentValue = false,
   Flag = "FlingToggle",
   Callback = function(Value)
      hiddenfling = Value
   end,
})

MainTab:CreateSlider({
   Name = "Fling Power",
   Range = {1000, 50000},
   Increment = 1000,
   Suffix = "Power",
   CurrentValue = 10000,
   Flag = "FlingPower",
   Callback = function(Value)
      flingPower = Value
   end,
})

MainTab:CreateToggle({
   Name = "Seat Invisibility",
   CurrentValue = false,
   Flag = "InvisToggle",
   Callback = function(Value)
      if Value ~= invis_on then
         toggleInvisibility()
      end
   end,
})

local SectionConnect = MainTab:CreateSection("Submission (Type Name -> Become Controlled)")

local connectInputName = ""

MainTab:CreateInput({
   Name = "Controller's Name",
   PlaceholderText = "Type Player Name to OBEY",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
       connectInputName = Text
   end,
})

MainTab:CreateButton({
   Name = "Submit & Obey",
   Callback = function()
       local t = findPlayerPartial(connectInputName)
       if t and t ~= LocalPlayer then
           controllerPlayer = t
           isSubordinate = true
           
           initSilentListener(t)
           
           updateStatus("CONTROLLED (By " .. t.Name .. ")", Color3.fromRGB(255, 50, 50))
           Notify("Submitted", "You are now controlled by " .. t.Name .. ". Auto-Stand active.", 5)
       else
           Notify("Error", "Player invalid or not found", 3)
       end
   end,
})

local RemoteTab = Window:CreateTab("Remote Admin", 4483362458)
local RemoteSection = RemoteTab:CreateSection("Control Your Subordinates")

RemoteTab:CreateButton({
   Name = "Jumpscare Them",
   Callback = function() sendCmd("jumpscare") end,
})

RemoteTab:CreateButton({
   Name = "Kill Them",
   Callback = function() sendCmd("kill") end,
})

RemoteTab:CreateButton({
   Name = "Fling Them (Up)",
   Callback = function() sendCmd("fling") end,
})

RemoteTab:CreateButton({
   Name = "Rocket Them (High)",
   Callback = function() sendCmd("rocket") end,
})

RemoteTab:CreateButton({
   Name = "Void Them",
   Callback = function() sendCmd("void") end,
})

RemoteTab:CreateButton({
   Name = "Freeze/Thaw",
   Callback = function() sendCmd("freeze") end,
})

RemoteTab:CreateButton({
   Name = "Force Fly",
   Callback = function() sendCmd("fly") end,
})

RemoteTab:CreateButton({
   Name = "Force Unfly",
   Callback = function() sendCmd("unfly") end,
})

local ModeSection = RemoteTab:CreateSection("Modes")

RemoteTab:CreateButton({
   Name = "Stand Pose (Reset)",
   Callback = function() sendCmd("stand") end,
})

RemoteTab:CreateButton({
   Name = "Orbit Mode",
   Callback = function() sendCmd("orbit") end,
})

RemoteTab:CreateButton({
   Name = "Carpet Mode (Lay Down)",
   Callback = function() sendCmd("carpet") end,
})

RemoteTab:CreateButton({
   Name = "Stop/Undo Pose",
   Callback = function() sendCmd("unstand") end,
})

local AttackSection = RemoteTab:CreateSection("Proxy Attacks")

RemoteTab:CreateButton({
   Name = "Attack My Target (Fling Once)",
   Callback = function() 
       Notify("Order", "Look at a player to order the attack!", 3)
       sendCmd("fling_target") 
   end,
})

local loopFlingTargetName = ""
RemoteTab:CreateInput({
   Name = "Target for Loop Fling",
   PlaceholderText = "Player Name",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      loopFlingTargetName = Text
   end,
})

RemoteTab:CreateButton({
   Name = "Loop Fling Target",
   Callback = function()
      if loopFlingTargetName ~= "" then
          sendCmd("loopfling " .. loopFlingTargetName)
      end
   end,
})

RemoteTab:CreateButton({
   Name = "Stop Loop Fling",
   Callback = function() sendCmd("stopfling") end,
})

local WaypointTab = Window:CreateTab("Waypoints", 4483362458)
local WaypointSection = WaypointTab:CreateSection("Manager")

local wpName = ""
WaypointTab:CreateInput({
   Name = "Waypoint Name",
   PlaceholderText = "e.g., Bank",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      wpName = Text
   end,
})

local WPDropdown

WaypointTab:CreateButton({
   Name = "Save Current Position",
   Callback = function()
       if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and wpName ~= "" then
           local pos = LocalPlayer.Character.HumanoidRootPart.Position
           waypoints[wpName] = {x = pos.X, y = pos.Y, z = pos.Z}
           saveWaypoints()
           WPDropdown:Refresh(getWaypointNames())
           Notify("Saved", "Waypoint " .. wpName .. " saved.", 2)
       end
   end,
})

WPDropdown = WaypointTab:CreateDropdown({
   Name = "Select Waypoint",
   Options = getWaypointNames(),
   CurrentOption = {""},
   MultipleOptions = false,
   Flag = "WPDropdown",
   Callback = function(Option)
   end,
})

WaypointTab:CreateButton({
   Name = "Teleport",
   Callback = function()
       local sel = WPDropdown.CurrentOption[1]
       if sel and waypoints[sel] and LocalPlayer.Character then
           local d = waypoints[sel]
           LocalPlayer.Character:MoveTo(Vector3.new(d.x, d.y, d.z))
       end
   end,
})

local ChatTab = Window:CreateTab("Chat Log", 4483362458)
local ChatSection = ChatTab:CreateSection("Server Chat")

local ChatScroll = nil

local function onChat(plr, msg)
    local time = os.date("%H:%M:%S")
    local fmt = "[" .. time .. "] " .. plr.Name .. ": " .. msg
    table.insert(chatLogs, 1, fmt)
    if #chatLogs > maxLogs then table.remove(chatLogs, #chatLogs) end
end

for _, p in pairs(Players:GetPlayers()) do
    p.Chatted:Connect(function(m) onChat(p, m) end)
end
Players.PlayerAdded:Connect(function(p)
    p.Chatted:Connect(function(m) onChat(p, m) end)
end)

local SectionVisuals = MainTab:CreateSection("Visuals")

MainTab:CreateToggle({
   Name = "Aura (Spinning Parts)",
   CurrentValue = false,
   Flag = "AuraToggle",
   Callback = function(Value)
      auraEnabled = Value
   end,
})

MainTab:CreateSlider({
   Name = "Field of View",
   Range = {70, 120},
   Increment = 1,
   Suffix = "FOV",
   CurrentValue = 70,
   Flag = "FOV",
   Callback = function(Value)
      Camera.FieldOfView = Value
   end,
})

MainTab:CreateToggle({
   Name = "ESP (Player Highlight)",
   CurrentValue = false,
   Flag = "ESPToggle",
   Callback = function(Value)
      espEnabled = Value
      if not Value then
          updateESP()
      end
   end,
})

MainTab:CreateToggle({
   Name = "Fullbright",
   CurrentValue = false,
   Flag = "FullbrightToggle",
   Callback = function(Value)
      if Value then
         Lighting.Brightness = 2
         Lighting.ClockTime = 14
         Lighting.FogEnd = 100000
         Lighting.GlobalShadows = false
         Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
      else
         Lighting.Brightness = 1
         Lighting.ClockTime = 12
         Lighting.FogEnd = 10000
         Lighting.GlobalShadows = true
         Lighting.OutdoorAmbient = Color3.fromRGB(127, 127, 127)
      end
   end,
})

local SectionMovement = MainTab:CreateSection("Movement")

MainTab:CreateToggle({
   Name = "Fly",
   CurrentValue = false,
   Flag = "FlyToggle",
   Callback = function(Value)
      flySettings.flying = Value
      if flySettings.flying then
          initFly()
      end
   end,
})

MainTab:CreateSlider({
   Name = "Fly Speed",
   Range = {10, 500},
   Increment = 10,
   Suffix = "Studs",
   CurrentValue = 50,
   Flag = "FlySpeed",
   Callback = function(Value)
      flySettings.speed = Value
   end,
})

MainTab:CreateToggle({
   Name = "Noclip",
   CurrentValue = false,
   Flag = "NoclipToggle",
   Callback = function(Value)
      noclip = Value
   end,
})

MainTab:CreateToggle({
   Name = "Infinite Jump",
   CurrentValue = false,
   Flag = "InfJumpToggle",
   Callback = function(Value)
      infJump = Value
   end,
})

MainTab:CreateSlider({
   Name = "WalkSpeed",
   Range = {16, 300},
   Increment = 1,
   Suffix = "Speed",
   CurrentValue = 16,
   Flag = "WalkSpeed",
   Callback = function(Value)
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.WalkSpeed = Value
      end
   end,
})

MainTab:CreateSlider({
   Name = "JumpPower",
   Range = {50, 500},
   Increment = 1,
   Suffix = "Power",
   CurrentValue = 50,
   Flag = "JumpPower",
   Callback = function(Value)
      if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
         LocalPlayer.Character.Humanoid.UseJumpPower = true
         LocalPlayer.Character.Humanoid.JumpPower = Value
      end
   end,
})

local SectionCombat = MainTab:CreateSection("Utility & Trolling")

MainTab:CreateToggle({
   Name = "SpinBot",
   CurrentValue = false,
   Flag = "SpinToggle",
   Callback = function(Value)
      spinEnabled = Value
   end,
})

MainTab:CreateSlider({
   Name = "Spin Speed",
   Range = {10, 100},
   Increment = 5,
   Suffix = "RPM",
   CurrentValue = 20,
   Flag = "SpinSpeed",
   Callback = function(Value)
      spinSpeed = Value
   end,
})

MainTab:CreateButton({
   Name = "Click TP Tool",
   Callback = function()
       local tool = Instance.new("Tool")
       tool.RequiresHandle = false
       tool.Name = "Click TP"
       tool.Activated:Connect(function()
           local pos = UserInputService:GetMouseLocation()
           local ray = Camera:ViewportPointToRay(pos.X, pos.Y)
           local res = workspace:Raycast(ray.Origin, ray.Direction * 1000)
           if res and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
               LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(res.Position + Vector3.new(0, 3, 0))
           end
       end)
       tool.Parent = LocalPlayer.Backpack
       Notify("Tool", "Click TP added to Backpack", 2)
   end,
})

local ScriptHubTab = Window:CreateTab("Script Hub", 4483362458)
local SectionScripts = ScriptHubTab:CreateSection("Pre-made Scripts")

ScriptHubTab:CreateButton({
   Name = "Infinite Yield",
   Callback = function()
      loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
   end,
})

ScriptHubTab:CreateButton({
   Name = "Remote Spy",
   Callback = function()
      loadstring(game:HttpGet("https://github.com/exxtremestuffs/SimpleSpySource/raw/master/SimpleSpy.lua"))()
   end,
})

local SectionTemp = ScriptHubTab:CreateSection("Temporary Executor")

local tempScript = ""

local TempInput = ScriptHubTab:CreateInput({
   Name = "Script Loader",
   PlaceholderText = "Paste script or loadstring here...",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      tempScript = Text
   end,
})

ScriptHubTab:CreateButton({
   Name = "Execute",
   Callback = function()
      if tempScript ~= "" then
          local func, loadErr = loadstring(tempScript)
          if not func then
              Notify("Syntax Error", tostring(loadErr), 3)
          else
              local success, err = pcall(func)
              if not success then
                  Notify("Runtime Error", tostring(err), 3)
              else
                  Notify("Success", "Script Executed", 2)
              end
          end
      end
   end,
})

ScriptHubTab:CreateButton({
   Name = "Clear",
   Callback = function()
      tempScript = ""
      TempInput:Set("")
   end,
})

local SectionSaved = ScriptHubTab:CreateSection("Saved Scripts Manager")

local savedScriptName = ""
local savedScriptCode = ""
local ScriptsDropdown

ScriptHubTab:CreateInput({
   Name = "Script Name",
   PlaceholderText = "e.g., Infinite Yield",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      savedScriptName = Text
   end,
})

ScriptHubTab:CreateInput({
   Name = "Script Code/URL",
   PlaceholderText = "Paste code here",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      savedScriptCode = Text
   end,
})

ScriptHubTab:CreateButton({
   Name = "Save Script",
   Callback = function()
      if savedScriptName ~= "" and savedScriptCode ~= "" then
          savedScripts[savedScriptName] = savedScriptCode
          saveScripts()
          Notify("Saved", savedScriptName .. " added!", 2)
          if ScriptsDropdown then
              ScriptsDropdown:Refresh(getScriptNames())
          end
      else
          Notify("Error", "Name or Code is empty", 2)
      end
   end,
})

ScriptsDropdown = ScriptHubTab:CreateDropdown({
   Name = "Your Saved Scripts",
   Options = getScriptNames(),
   CurrentOption = {""},
   MultipleOptions = false,
   Flag = "ScriptsDropdown",
   Callback = function(Option)
   end,
})

ScriptHubTab:CreateButton({
   Name = "Execute Selected",
   Callback = function()
      local selected = ScriptsDropdown.CurrentOption[1]
      if selected and savedScripts[selected] then
          local code = savedScripts[selected]
          local func, loadErr = loadstring(code)
          if not func then
             Notify("Error", tostring(loadErr), 3)
          else
             local success, err = pcall(func)
             if not success then
                 Notify("Error", tostring(err), 3)
             else
                 Notify("Executed", selected, 2)
             end
          end
      end
   end,
})

ScriptHubTab:CreateButton({
   Name = "Delete Selected",
   Callback = function()
      local selected = ScriptsDropdown.CurrentOption[1]
      if selected and savedScripts[selected] then
          savedScripts[selected] = nil
          saveScripts()
          ScriptsDropdown:Refresh(getScriptNames())
          Notify("Deleted", selected .. " removed.", 2)
      end
   end,
})

local InfoTab = Window:CreateTab("Player Info", 4483362458)
local InfoSection = InfoTab:CreateSection("Get Player Details")

local infoTargetName = ""

InfoTab:CreateInput({
   Name = "Player Name",
   PlaceholderText = "e.g., brian",
   RemoveTextAfterFocusLost = false,
   Callback = function(Text)
      infoTargetName = Text
   end,
})

InfoTab:CreateButton({
   Name = "Get Info",
   Callback = function()
       local target = findPlayerPartial(infoTargetName)
       if target then
           local char = target.Character
           local health = "N/A"
           local maxHealth = "N/A"
           local team = target.Team and target.Team.Name or "Neutral"
           local tool = "None"
           local pos = "N/A"
           
           if char then
               local hum = char:FindFirstChild("Humanoid")
               if hum then
                   health = math.floor(hum.Health)
                   maxHealth = math.floor(hum.MaxHealth)
               end
               local equip = char:FindFirstChildOfClass("Tool")
               if equip then tool = equip.Name end
               local hrp = char:FindFirstChild("HumanoidRootPart")
               if hrp then
                   pos = math.floor(hrp.Position.X) .. ", " .. math.floor(hrp.Position.Y) .. ", " .. math.floor(hrp.Position.Z)
               end
           end
           
           local age = target.AccountAge
           Notify("Info: " .. target.Name, "HP: " .. health .. "\nTeam: " .. team .. "\nTool: " .. tool .. "\nAge: " .. age .. " days", 10)
       else
           Notify("Error", "Player not found", 3)
       end
   end,
})

local MiscTab = Window:CreateTab("Misc", 4483362458)
local MiscSection = MiscTab:CreateSection("Extra")

MiscTab:CreateButton({
   Name = "Rejoin Server",
   Callback = function()
      game:GetService("TeleportService"):Teleport(game.PlaceId, LocalPlayer)
   end,
})

MiscTab:CreateButton({
   Name = "Destroy UI",
   Callback = function()
      Rayfield:Destroy()
   end,
})
